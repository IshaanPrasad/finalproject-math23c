rm(list=ls())
set.seed(123)
#Change this to location of your data
#Can use drop down menu in R studio: file->import data set-> from stata and find stata data set
setwd("/Users/abhishekmalani/Desktop/Math 23C/Data")
if (!require(foreign)) install.packages("foreign"); library(foreign)
if (!require(haven)) install.packages("haven"); library(haven)
census <- read.csv("finalproject.csv")
head(census)
index <- which(!is.na(census$Income) & !is.na(census$CensusTract) & !is.na(census$State)
& !is.na(census$County) & !is.na(census$TotalPop) & !is.na(census$Citizen)& !is.na(census$Men)
& !is.na(census$Women) & !is.na(census$Hispanic) & !is.na(census$White) & !is.na(census$Black)
& !is.na(census$Native) & !is.na(census$Asian) & !is.na(census$Pacific) & !is.na(census$IncomeErr)
& !is.na(census$IncomePerCap) & !is.na(census$IncomePerCapErr) & !is.na(census$Poverty)
& !is.na(census$ChildPoverty) & !is.na(census$Professional) & !is.na(census$Service)
& !is.na(census$Office) & !is.na(census$Construction) & !is.na(census$Production)
& !is.na(census$Drive) & !is.na(census$Carpool) & !is.na(census$Transit) & !is.na(census$Walk)
& !is.na(census$OtherTransp) & !is.na(census$WorkAtHome) & !is.na(census$MeanCommute)
& !is.na(census$Employed) & !is.na(census$PrivateWork) & !is.na(census$PublicWork)
& !is.na(census$SelfEmployed) & !is.na(census$FamilyWork) & !is.na(census$Unemployment)               )
clean <- census[index,]
head(clean)
write.csv(clean,"clean.csv")  #look at this in Excel or as a text file
median(clean$Income)
length(clean$Income)
head(clean)
median(clean$Income)
length(clean$Income)
hist(clean$Income)
h = hist(clean$Income, probability = TRUE) # or hist(x,plot=FALSE) to avoid the plot of the histogram
h$density = h$counts/sum(h$counts)
plot(h,freq=FALSE)
#To find the best fitting normal distribution, compute the mean and variance of the data
mu <- mean(clean$Income); mu
sigma <- sd(clean$Income)     #estimates square root of the population variance
curve(dnorm(x, mu, sigma), from = 0, to = 250000, add = TRUE, col = "red")
head(clean)
income = clean$Income
hispanic = clean$Hispanic
white = clean$White
black = clean$Black
native = clean$Native
asian = clean$Asian
pacific = clean$Pacific
mostlywhite = clean[which(white>80)]
mostlywhite = clean$Income[which(white>80)]
mostlywhite = clean$Income[which(white>80)]; mostlywhite
mostlyblack = clean$Income[which(black>80)]; mostlyblack
mostlyhispanic = clean$Income[which(hispanic>80)]
mostlyasian = clean$Income[which(asian>80)]
mostlywhite = clean$Income[which(white>80)]; mostlywhite; length(mostlywhite)
mostlyblack = clean$Income[which(black>80)];  length(mostlyblack)
mostlyhispanic = clean$Income[which(hispanic>80)];  length(mostlyhispanic)
mostlyasian = clean$Income[which(asian>80)]; length(mostlyasian)
mostlynative = clean$Income[which(native>80)]; length(mostlynative)
mostlypacific = clean$Income[which(pacific>80)]; length(mostlypacific)
mostlywhite = clean$Income[which(white>75)]; mostlywhite; length(mostlywhite)
mostlyblack = clean$Income[which(black>75)];  length(mostlyblack)
mostlyhispanic = clean$Income[which(hispanic>75)];  length(mostlyhispanic)
mostlyasian = clean$Income[which(asian>75)]; length(mostlyasian)
mostlynative = clean$Income[which(native>75)]; length(mostlynative)
mostlypacific = clean$Income[which(pacific>75)]; length(mostlypacific)
head(clean)
mean(clean$Asian)
mostlyasian = clean$Income[which(asian>50)]; length(mostlyasian)
whiteincome = mean(mostlywhite)
blackincome = mean(mostlyblack)
hispanicincome = mean(mostlyhispanic)
asianincome = mean(mostlyasian)
nativeincome = mean(mostlynative)
mostlypacific = clean$Income[which(pacific>50)]; length(mostlypacific)
mostlypacific = clean$Income[which(pacific>75)]; length(mostlypacific)
pacificincome = mean(mostlypacific)
whiteincome; blackincome;hispanicincome;asianincome;nativeincome;pacificincome
plot(whiteincome; blackincome;hispanicincome;asianincome;nativeincome;pacificincome)
plot(whiteincome, blackincome, hispanicincome, asianincome, nativeincome, pacificincome)
barplot(whiteincome, blackincome, hispanicincome, asianincome, nativeincome, pacificincome)
?barplot
barplot(c(whiteincome, blackincome, hispanicincome, asianincome, nativeincome, pacificincome))
barplot(c(whiteincome, blackincome, hispanicincome, asianincome, nativeincome, pacificincome), names.arg = c("white", "black", "hispanic", "asian", "native", "pacific"))
barplot(c(whiteincome, blackincome, hispanicincome, asianincome, nativeincome, pacificincome), names.arg = c("white", "black", "hispanic", "asian", "native", "pacific"), col =c("white", "black","brown", "yellow", "red", "blue"))
barplot(c(whiteincome, blackincome, hispanicincome, asianincome, nativeincome, pacificincome), names.arg = c("white", "black", "hispanic", "asian", "native", "pacific"), col =c("white", "black","brown", "yellow", "red", "tan"))
barplot(c(whiteincome, blackincome, hispanicincome, asianincome, nativeincome, pacificincome), names.arg = c("white", "black", "hispanic", "asian", "native", "pacific"), col =c("white", "black","brown", "yellow", "red", "tan"),main = "Income")
barplot(c(whiteincome, blackincome, hispanicincome, asianincome, nativeincome, pacificincome), names.arg = c("white", "black", "hispanic", "asian", "native", "pacific"),main = "Income")
plot(c(0,0), (1,200000))
c
plot(c(0,0), c(1,200000))
scatter.smooth(c(0,0), c(1,200000))
scatter.smooth(c(0,0), c(1,200000))
scatter.smooth(c(0,1), c(0,200000))
plot(c(0,1), c(0,200000))
hispanic = which(clean$Hispanic>75)
white = which(clean$White>75)
black = which(clean$Black>75)
native = which(clean$Native>75)
asian = which(clean$Asian>75)
pacific = which(clean$Pacific>75)
mostlywhite = clean$Income[white]; mostlywhite; length(mostlywhite)
mostlyblack = clean$Income[black];  length(mostlyblack)
mostlyhispanic = clean$Income[hispanic];  length(mostlyhispanic)
mostlyasian = clean$Income[asian]; length(mostlyasian)
mostlynative = clean$Income[native]; length(mostlynative)
mostlypacific = clean$Income[pacific]; length(mostlypacific)
whiteincome = mean(mostlywhite)
blackincome = mean(mostlyblack)
hispanicincome = mean(mostlyhispanic)
asianincome = mean(mostlyasian)
nativeincome = mean(mostlynative)
pacificincome = mean(mostlypacific)
whiteincome; blackincome;hispanicincome;asianincome;nativeincome;pacificincome
barplot(c(whiteincome, blackincome, hispanicincome, asianincome, nativeincome, pacificincome), names.arg = c("white", "black", "hispanic", "asian", "native", "pacific"),main = "Income")
hispanic = which(clean$Hispanic>75);  length(mostlyhispanic)
white = which(clean$White>75); length(mostlywhite)
black = which(clean$Black>75);  length(mostlyblack)
native = which(clean$Native>75); length(mostlynative)
asian = which(clean$Asian>75); length(mostlyasian)
pacific = which(clean$Pacific>75); length(mostlypacific)
whitepoverty = mean(mostlywhite)
blackpoverty = mean(mostlyblack)
hispanicpoverty = mean(mostlyhispanic)
asianpoverty = mean(mostlyasian)
nativepoverty = mean(mostlynative)
pacificpoverty = mean(mostlypacific)
whitepoverty; blackpoverty;hispanicpoverty;asianpoverty;nativepoverty;pacificpoverty
mostlywhite = clean$Poverty[white]
mostlyblack = clean$Poverty[black]
mostlyhispanic = clean$Poverty[hispanic]
mostlyasian = clean$Poverty[asian]
mostlynative = clean$Poverty[native]
mostlypacific = clean$Poverty[pacific]
whitepoverty = mean(mostlywhite)
blackpoverty = mean(mostlyblack)
hispanicpoverty = mean(mostlyhispanic)
asianpoverty = mean(mostlyasian)
nativepoverty = mean(mostlynative)
pacificpoverty = mean(mostlypacific)
whitepoverty; blackpoverty;hispanicpoverty;asianpoverty;nativepoverty;pacificpoverty
barplot(c(whitepoverty,blackpoverty,hispanicpoverty,asianpoverty,nativepoverty,pacificpoverty), names.arg = c("white", "black", "hispanic", "asian", "native", "pacific"),main = "Income")
barplot(c(whitepoverty,blackpoverty,hispanicpoverty,asianpoverty,nativepoverty,pacificpoverty), names.arg = c("white", "black", "hispanic", "asian", "native", "pacific"),main = "Poverty")
rm(list=ls())
set.seed(123)
#Change this to location of your data
setwd("/Users/abhishekmalani/Desktop/Math 23C/finalproject-math23c")
?setwd
getwd()
setwd("/Users/abhishekmalani/Desktop/Math 23C/Data")
setwd("Users/abhishekmalani/Desktop/Math 23C/Data")
#Change this to location of your data
#Can use drop down menu in R studio: file->import data set-> from stata and find stata data set
setwd("/Users/Abhishekmalani/Desktop/Math 23C/Data")
#Change this to location of your data
setwd(/Users/abhishekmalani/Desktop/Math 23C/finalproject-math23c)
getwd()
#Change this to location of your data
#Can use drop down menu in R studio: file->import data set-> from stata and find stata data set
setwd("/Users/Massimo/Documents/Math 23c/Data")
#Change this to location of your data
#Can use drop down menu in R studio: file->import data set-> from stata and find stata data set
setwd("/Users/abishekmalani/Documents/Math 23c")
#Change this to location of your data
#Can use drop down menu in R studio: file->import data set-> from stata and find stata data set
setwd("/abishekmalani/Documents/Math 23c")
#Topic 4: Logistic regression
SOX <- read.csv("RedSox2013.csv"); head(SOX)
#Convert the WonLost column to a Bernoulli random variable
wins <- (as.numeric(SOX$WonLost=="W")); head(wins)
#Extract the runs scored column
runs <- SOX$R
plot(runs,wins)  #not a great candidate for a straight-line approximation, but let's try
b <- cov(runs,wins)/var(runs)    #easy way to get the slope
#Here is the formula for the intercept
a <- mean(wins) - b*mean(runs);a
#We can add this regression line to the plot of the data
abline(a, b, col = "red")
#Instead, we assume that p = exp(alpha x+beta)/(1 + exp(alpha x+beta))
#This function can never be less than zero nor greater than 1
#Start with minus the log of the likelihood function
MLL<- function(alpha, beta) {
-sum( log( exp(alpha+beta*runs)/(1+exp(alpha+beta*runs)) )*wins
+ log(1/(1+exp(alpha+beta*runs)))*(1-wins) )
}
#R has a function that will maximize this function of alpha and beta
#install.packages("stats4")   #needs to be run at most once
library(stats4)
results<-mle(MLL, start = list(alpha = 0, beta = 0)) #an initial guess is required
results@coef
curve( exp(results@coef[1]+results@coef[2]*x)/ (1+exp(results@coef[1]+results@coef[2]*x)),col = "blue", add=TRUE)
#The curve shows a good model for the probability of winning as a function of runs
abline(h=0.5)
abline(v=c(3,4))
index <- which(runs == 3); head(index)   #games with 3 runs
mean(wins[index])   #won 34%
index <- which(runs == 4)    #games with 4 runs
mean(wins[index])   #won 63%
index <- which(runs == 7)    #games with 7 runs
mean(wins[index])   #won 88%
index <- which(runs == 9)    #games with 9 runs
mean(wins[index])   #won 100%
if (!require(stats4)) install.packages("stats4"); library(stats4)
barplot(c(whiteincome, blackincome, hispanicincome, asianincome, nativeincome, pacificincome), names.arg = c("white", "black", "hispanic", "asian", "native", "pacific"),main = "Income")
clean = read.csv("clean.csv")
rm(list=ls())
set.seed(123)
#Change this to location of your data
#Can use drop down menu in R studio: file->import data set-> from stata and find stata data set
setwd("/Users/abhishekmalani/Desktop/Math 23C/Data")
if (!require(foreign)) install.packages("foreign"); library(foreign)
if (!require(haven)) install.packages("haven"); library(haven)
if (!require(randomForest)) install.packages("randomForest"); library(randomForest)
if (!require(rpart)) install.packages("rpart"); library(rpart)
if (!require(stats4)) install.packages("stats4"); library(stats4)
census <- read.csv("finalproject.csv")
census <- read.csv("finalproject.csv")
census <- read.csv("finalproject.csv")
rm(list=ls())
set.seed(123)
#Change this to location of your data
#Can use drop down menu in R studio: file->import data set-> from stata and find stata data set
setwd("/Users/abhishekmalani/Desktop/Math 23C/Data")
if (!require(foreign)) install.packages("foreign"); library(foreign)
if (!require(haven)) install.packages("haven"); library(haven)
if (!require(randomForest)) install.packages("randomForest"); library(randomForest)
if (!require(rpart)) install.packages("rpart"); library(rpart)
if (!require(stats4)) install.packages("stats4"); library(stats4)
census <- read.csv("finalproject.csv")
clean = read.csv("clean.csv")
rm(list=ls())
set.seed(123)
setwd("/Users/Massimo/Documents/Math 23C/finalproject-math23c")
clean = read.csv("clean.csv")
####bar plot
income = clean$Income
#Topic 4: Logistic regression
pcincome = clean$IncomePerCap
hist(pcimcome)
hist(pcincome)
hist(log(pcincome))
hist(pcincome)
max(pcincome)
#Topic 4: Logistic regression
pcincome = clean$Income
hist(pcincome)
hist(log(pcincome))
#Topic 4: Logistic regression
income = clean$Income
poor <- (as.numeric(income<=11)); head(poor)
professional <- clean$Professional
plot(professional,wealthy)  #not a great candidate for a straight-line approximation, but let's try
wealthy <- (as.numeric(income>=11)); head(wealthy)
professional <- clean$Professional
plot(professional,wealthy)  #not a great candidate for a straight-line approximation, but let's try
lincome = log(income)
wealthy <- (as.numeric(lincome>=11)); head(wealthy)
professional <- clean$Professional
plot(professional,wealthy)  #not a great candidate for a straight-line approximation, but let's try
wealthy <- (as.numeric(income>=50000)); head(wealthy)
professional <- clean$Professional
plot(professional,wealthy)  #not a great candidate for a straight-line approximation, but let's try
wealthy <- (as.numeric(income>=100000)); head(wealthy)
professional <- clean$Professional
plot(professional,wealthy)  #not a great candidate for a straight-line approximation, but let's try
log(100000)
wealthy <- (as.numeric(lincome>=11.51293)); head(wealthy)
professional <- clean$Professional
plot(professional,wealthy)  #not a great candidate for a straight-line approximation, but let's try
hist(professional)
hist(log(professional))
citizen = clean$Citizen/clean$TotalPop
hist(citizen)
wealthy <- (as.numeric(income>=50000)); head(wealthy)
plot(citizen,wealthy)  #not a great candidate for a straight-line approximation, but let's try
white = clean$White
hist(white)
wealthy <- (as.numeric(income>=50000)); head(wealthy)
plot(white,wealthy)  #not a great candidate for a straight-line approximation, but let's try
asian = clean$Asian
hist(asian)
hist(log(asian))
wealthy <- (as.numeric(income>=50000)); head(wealthy)
plot(asian,wealthy)  #not a great candidate for a straight-line approximation, but let's try
plot(log(asian),wealthy)  #not a great candidate for a straight-line approximation, but let's try
black = clean$Black
hist(black)
wealthy <- (as.numeric(income>=50000)); head(wealthy)
plot(black,wealthy)  #not a great candidate for a straight-line approximation, but let's try
mass = income[which(clean$State = "Massachusetts")]
mass = income[which(clean$State == "Massachusetts")]
mass = which(clean$State == "Massachusetts")
professional = clean$Professional[mass]
hist(professional)
wealthy <- (as.numeric(income>=50000)); head(wealthy)
wealthy <- (as.numeric(income[mass]>=50000)); head(wealthy)
plot(professional,wealthy)  #not a great candidate for a straight-line approximation, but let's try
MLL<- function(alpha, beta) {
-sum( log( exp(alpha+beta*professional)/(1+exp(alpha+beta*professional)) )*wealthy
+ log(1/(1+exp(alpha+beta*professional)))*(1-wealthy) )
}
results<-mle(MLL, start = list(alpha = 0, beta = 0)) #an initial guess is required
results@coef
curve( exp(results@coef[1]+results@coef[2]*x)/ (1+exp(results@coef[1]+results@coef[2]*x)),col = "blue", add=TRUE)
if (!require(stats4)) install.packages("stats4"); library(stats4)
MLL<- function(alpha, beta) {
-sum( log( exp(alpha+beta*professional)/(1+exp(alpha+beta*professional)) )*wealthy
+ log(1/(1+exp(alpha+beta*professional)))*(1-wealthy) )
}
results<-mle(MLL, start = list(alpha = 0, beta = 0)) #an initial guess is required
results@coef
curve( exp(results@coef[1]+results@coef[2]*x)/ (1+exp(results@coef[1]+results@coef[2]*x)),col = "blue", add=TRUE)
abline(h=0.5)
abline(v=c(20,40))
index <- which(constr.prod >= 19 & constr.prod <= 21); head(index)   #games with 3 runs
index <- which(professional >= 19 & professional <= 21); head(index)   #games with 3 runs
mean(wealthy[index])   #won 34%
index <- which(professional >= 39 & professional <= 41); head(index)   #games with 3 runs
mean(wealthy[index])   #won 63%
wealthy <- (as.numeric(income[mass]>=100000)); head(wealthy)
plot(professional,wealthy)  #not a great candidate for a straight-line approximation, but let's try
MLL<- function(alpha, beta) {
-sum( log( exp(alpha+beta*professional)/(1+exp(alpha+beta*professional)) )*wealthy
+ log(1/(1+exp(alpha+beta*professional)))*(1-wealthy) )
}
results<-mle(MLL, start = list(alpha = 0, beta = 0)) #an initial guess is required
results@coef
curve( exp(results@coef[1]+results@coef[2]*x)/ (1+exp(results@coef[1]+results@coef[2]*x)),col = "blue", add=TRUE)
wealthy <- (as.numeric(income[mass]>=60000)); head(wealthy)
plot(professional,wealthy)  #not a great candidate for a straight-line approximation, but let's try
MLL<- function(alpha, beta) {
-sum( log( exp(alpha+beta*professional)/(1+exp(alpha+beta*professional)) )*wealthy
+ log(1/(1+exp(alpha+beta*professional)))*(1-wealthy) )
}
results<-mle(MLL, start = list(alpha = 0, beta = 0)) #an initial guess is required
results@coef
curve( exp(results@coef[1]+results@coef[2]*x)/ (1+exp(results@coef[1]+results@coef[2]*x)),col = "blue", add=TRUE)
abline(h=0.5)
abline(v=c(20,40))
index <- which(professional >= 19 & professional <= 21); head(index)   #games with 3 runs
mean(wealthy[index])   #won 34%
wealthy <- (as.numeric(income[mass]>=70000)); head(wealthy)
plot(professional,wealthy)  #not a great candidate for a straight-line approximation, but let's try
MLL<- function(alpha, beta) {
-sum( log( exp(alpha+beta*professional)/(1+exp(alpha+beta*professional)) )*wealthy
+ log(1/(1+exp(alpha+beta*professional)))*(1-wealthy) )
}
results<-mle(MLL, start = list(alpha = 0, beta = 0)) #an initial guess is required
results@coef
curve( exp(results@coef[1]+results@coef[2]*x)/ (1+exp(results@coef[1]+results@coef[2]*x)),col = "blue", add=TRUE)
abline(h=0.5)
abline(v=c(40,60))
abline(v=c(30,50))
curve( exp(results@coef[1]+results@coef[2]*x)/ (1+exp(results@coef[1]+results@coef[2]*x)),col = "blue", add=TRUE)
abline(h=0.5)
abline(v=c(30,50))
plot(professional,wealthy)  #not a great candidate for a straight-line approximation, but let's try
curve( exp(results@coef[1]+results@coef[2]*x)/ (1+exp(results@coef[1]+results@coef[2]*x)),col = "blue", add=TRUE)
abline(h=0.5)
abline(v=c(30,50))
index <- which(professional >= 29 & professional <= 31); head(index)   #games with 3 runs
mean(wealthy[index])   #won 34%
wealthy <- (as.numeric(income[mass]>=50000)); head(wealthy)
plot(professional,wealthy)  #not a great candidate for a straight-line approximation, but let's try
MLL<- function(alpha, beta) {
-sum( log( exp(alpha+beta*professional)/(1+exp(alpha+beta*professional)) )*wealthy
+ log(1/(1+exp(alpha+beta*professional)))*(1-wealthy) )
}
results<-mle(MLL, start = list(alpha = 0, beta = 0)) #an initial guess is required
results@coef
curve( exp(results@coef[1]+results@coef[2]*x)/ (1+exp(results@coef[1]+results@coef[2]*x)),col = "blue", add=TRUE)
abline(h=0.5)
abline(v=c(20,40))
index <- which(professional >= 19 & professional <= 21); head(index)   #games with 3 runs
mean(wealthy[index])   #won 34%
index <- which(professional >= 39 & professional <= 41); head(index)   #games with 3 runs
mean(wealthy[index])   #won 63%
abline(v=20, col = "red"); abline(v=40, col = "green")
index <- which(professional >= 19 & professional <= 21); head(index)   #games with 3 runs
mean(wealthy[index])   #won 34%
a = mean(wealthy[index]); a   #won 34%
abline(h=a, col = "red")
index <- which(professional >= 39 & professional <= 41); head(index)   #games with 3 runs
mean(wealthy[index])   #won 63%
b = mean(wealthy[index]); b   #won 63%
abline(h=b, col = "green")
plot(professional,wealthy)  #not a great candidate for a straight-line approximation, but let's try
curve( exp(results@coef[1]+results@coef[2]*x)/ (1+exp(results@coef[1]+results@coef[2]*x)),col = "blue", add=TRUE)
abline(v=20, col = "red"); abline(v=40, col = "green")
curve( exp(results@coef[1]+results@coef[2]*x)/ (1+exp(results@coef[1]+results@coef[2]*x)),col = "blue", add=TRUE)
abline(v=20, col = "red"); abline(v=40, col = "green")
index <- which(professional >= 19 & professional <= 21); head(index)   #games with 3 runs
a = mean(wealthy[index]); a   #won 34%
abline(h=a, col = "red")
index <- which(professional >= 39 & professional <= 41); head(index)   #games with 3 runs
b = mean(wealthy[index]); b   #won 63%
abline(h=b, col = "green")
h = hist(clean$Income, probability = TRUE) # or hist(x,plot=FALSE) to avoid the plot of the histogram
h$density = h$counts/sum(h$counts)
plot(h,freq=FALSE)
#To find the best fitting normal distribution, compute the mean and variance of the data
mu <- mean(clean$Income); mu
sigma <- sd(clean$Income)     #estimates square root of the population variance
curve(dnorm(x, mu, sigma), from = 0, to = 250000, add = TRUE, col = "red")
plot(professional,wealthy)  #not a great candidate for a straight-line approximation, but let's try
results<-mle(MLL, start = list(alpha = 0, beta = 0)) #an initial guess is required
results@coef
curve( exp(results@coef[1]+results@coef[2]*x)/ (1+exp(results@coef[1]+results@coef[2]*x)),col = "blue", add=TRUE)
abline(v=20, col = "red"); abline(v=40, col = "green")
index <- which(professional >= 19 & professional <= 21); head(index)   #games with 3 runs
a = mean(wealthy[index]); a   #won 34%
abline(h=a, col = "red")
index <- which(professional >= 39 & professional <= 41); head(index)   #games with 3 runs
b = mean(wealthy[index]); b   #won 63%
abline(h=b, col = "green")
### 95% Confidence Interval ###
#Point 20 - confidence interval
commute = clean$MeanCommute
µ = mean(commute); µ  #population mean
sigma = sd(commute); sigma  #population standard deviation
hist(commute, probability = T)  #looks approximately normal, just a little bit skewed to the right
f = function(x) dnorm(x,µ, sigma)
curve(f, add=T, col = "blue")
N = length(commute); N
n = 5000
sample = sample(N,n) #Point 2 - drew random samples from large (72727 entries) population
sample = sample(N,n) #Point 2 - drew random samples from large population (72727 entries)
xbar = mean(commute[sample])  #sample mean
s = sd(commute[sample]);s  #sample standard deviation
### 95% Confidence Interval ###
#Point 20 - confidence interval
commute = clean$MeanCommute
µ = mean(commute); µ  #population mean
sigma = sd(commute); sigma  #population standard deviation
hist(commute, probability = T)  #looks approximately normal, just a little bit skewed to the right
f = function(x) dnorm(x,µ, sigma)
curve(f, add=T, col = "blue")
N = length(commute); N
n = 5000
sample = sample(N,n) #Point 2 - drew random samples from large population (72727 entries)
xbar = mean(commute[sample])  #sample mean
s = sd(commute[sample]);s  #sample standard deviation
lower = xbar - 1.96*s/sqrt(n); lower
upper = xbar + 1.96*s/sqrt(n); upper
counter <- 0
plot(x =c(µ-2,µ+2), y = c(1,100), type = "n", xlab = "", ylab = "")
for (i in 1:100) {
sample = sample(N,n)
xbar = mean(commute[sample])
s = sd(commute[sample])
lower = xbar - 1.96*s/sqrt(n)
upper = xbar + 1.96*s/sqrt(n)
if (lower < µ && µ < upper) counter <- counter + 1
if(i <= 100) {
points(lower, i, pch= 22)
points(upper, i, pch= 23)
segments(lower, i, upper, i)
}
}
abline (v = µ, col = "red") #vertical line at population mean
#What percentage of the time does the interval contain the population mean?
counter/100  #around 95% most of the time
hist(professional)
which(professional=20)
which(professional==20)
which(professional==40)
a = mean(wealthy[index]); a   #won 34%
index <- which(professional >= 19 & professional <= 21); head(index)   #evaluated in a small range of values around 20, because very few tracts were exactly equal to 20 and might not give an accurate estimate
a = mean(wealthy[index]); a   #won 34%
b = mean(wealthy[index]); b   #
abline(h=b, col = "green")
index <- which(professional >= 39 & professional <= 41); head(index)   #evaluated in a small range of values around 40, because very few tracts were exactly equal to 40 and might not give an accurate estimate
b = mean(wealthy[index]); b   #
